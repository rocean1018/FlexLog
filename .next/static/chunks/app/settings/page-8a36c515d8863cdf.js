(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[662],{1166:(e,t,r)=>{"use strict";r.d(t,{$:()=>l});var s=r(5155);r(2115);var a=r(4269);function l(e){let{className:t,variant:r="primary",size:l="md",...i}=e;return(0,s.jsx)("button",{className:(0,a.cn)("inline-flex items-center justify-center rounded-full font-semibold uppercase tracking-wide transition duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-sky-400 disabled:opacity-60","primary"===r&&"bg-gradient-to-r from-sky-400 via-fuchsia-500 to-emerald-400 text-white shadow-[0_15px_35px_rgba(8,47,73,0.45)] hover:opacity-90","secondary"===r&&"border border-white/15 bg-white/10 text-white shadow-[0_10px_25px_rgba(0,0,0,0.4)] hover:bg-white/20","ghost"===r&&"text-white/80 hover:text-white hover:bg-white/10","destructive"===r&&"bg-gradient-to-r from-rose-500 to-orange-500 text-white shadow-[0_15px_35px_rgba(127,29,29,0.45)] hover:opacity-90","sm"===l&&"px-3.5 py-1.5 text-[11px]","md"===l&&"px-4 py-2 text-sm","lg"===l&&"px-5 py-2.5 text-base",t),...i})}},2417:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>x});var s=r(5155),a=r(2619),l=r.n(a),i=r(5795),n=r(7972),o=r(1166),d=r(5590),c=r(3698),u=r(3449),g=r(2115),h=r(4734);function x(){var e,t,r,a,x;let m=(0,u.P)(),p=m.getTargets(),[v,b]=(0,g.useState)(null!=(e=m.getUnits())?e:"lb"),w=m.getOnboarding(),[y,f]=(0,g.useState)(m.getStrengthTrackerEnabled()),[j,N]=(0,g.useState)(()=>{let e=m.getBodyweightOverride();return null==e?"":String(e)}),[k,S]=(0,g.useState)(null!=(t=null==p?void 0:p.calories)?t:2e3),[_,O]=(0,g.useState)(null!=(r=null==p?void 0:p.protein_g)?r:160),[D,C]=(0,g.useState)(null!=(a=null==p?void 0:p.carbs_g)?a:200),[L,T]=(0,g.useState)(null!=(x=null==p?void 0:p.fat_g)?x:60);function E(){m.setUnits(v),m.setTargets({calories:k,protein_g:_,carbs_g:D,fat_g:L}),m.setStrengthTrackerEnabled(y);let e=j.trim()?Number(j):null;m.setBodyweightOverride(Number.isFinite(e)?e:null),h.o.success("Settings saved")}return(0,s.jsxs)("div",{className:"mx-auto max-w-3xl px-4 py-6",children:[(0,s.jsx)(i.V,{title:"Settings",subtitle:"Targets, units, export",right:(0,s.jsx)(l(),{href:"/log",children:(0,s.jsx)(o.$,{variant:"secondary",children:"Back to log"})})}),(0,s.jsxs)("div",{className:"mt-4 grid gap-4",children:[(0,s.jsxs)(n.Z,{children:[(0,s.jsx)("div",{className:"text-sm text-zinc-400",children:"Units"}),(0,s.jsx)("div",{className:"mt-3 max-w-xs",children:(0,s.jsx)(c.l,{label:"Bodyweight units",value:v,onChange:e=>b(e),options:[{value:"lb",label:"lb"},{value:"kg",label:"kg"}]})})]}),(0,s.jsxs)(n.Z,{children:[(0,s.jsx)("div",{className:"text-sm text-zinc-400",children:"Daily targets"}),(0,s.jsxs)("div",{className:"mt-3 grid gap-3 sm:grid-cols-2",children:[(0,s.jsx)(d.p,{label:"Calories",type:"number",value:k,onChange:e=>S(Number(e.target.value))}),(0,s.jsx)(d.p,{label:"Protein (g)",type:"number",value:_,onChange:e=>O(Number(e.target.value))}),(0,s.jsx)(d.p,{label:"Carbs (g)",type:"number",value:D,onChange:e=>C(Number(e.target.value))}),(0,s.jsx)(d.p,{label:"Fat (g)",type:"number",value:L,onChange:e=>T(Number(e.target.value))})]}),(0,s.jsx)("div",{className:"mt-4 flex justify-end",children:(0,s.jsx)(o.$,{onClick:E,children:"Save"})})]}),(0,s.jsxs)(n.Z,{children:[(0,s.jsx)("div",{className:"text-sm text-zinc-400",children:"Strength tracker"}),(0,s.jsxs)("div",{className:"mt-3 grid gap-3 sm:grid-cols-2 sm:items-end",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-zinc-300",children:"Strength Index"}),(0,s.jsx)("div",{className:"mt-1 text-xs text-zinc-500",children:"Computes an estimated 1RM trend from logged weights and normalizes it by bodyweight."}),(0,s.jsx)("div",{className:"mt-3",children:(0,s.jsx)(o.$,{variant:y?"secondary":"ghost",onClick:()=>f(e=>!e),children:y?"Enabled":"Disabled"})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(d.p,{label:"Bodyweight override (".concat(v,") (optional)"),placeholder:(null==w?void 0:w.weight)?"Using onboarding: ".concat(w.weight," ").concat(w.units):"Set in onboarding",value:j,onChange:e=>N(e.target.value)}),(0,s.jsx)("div",{className:"mt-1 text-xs text-zinc-500",children:"Leave blank to use your onboarding bodyweight."})]})]}),(0,s.jsx)("div",{className:"mt-4 flex justify-end",children:(0,s.jsx)(o.$,{onClick:E,children:"Save"})})]}),(0,s.jsxs)(n.Z,{children:[(0,s.jsx)("div",{className:"text-sm text-zinc-400",children:"Data"}),(0,s.jsxs)("div",{className:"mt-3 flex flex-col gap-2 sm:flex-row",children:[(0,s.jsx)(o.$,{variant:"secondary",onClick:()=>{let e=new Blob([JSON.stringify(m.exportAll(),null,2)],{type:"application/json"}),t=URL.createObjectURL(e),r=document.createElement("a");r.href=t,r.download="flexlog-export.json",r.click(),URL.revokeObjectURL(t)},children:"Export JSON"}),(0,s.jsx)(o.$,{variant:"destructive",onClick:()=>{confirm("Delete all local data?")&&(m.clearAll(),h.o.success("Local data cleared"),location.href="/")},children:"Delete local data"})]})]})]})]})}},3449:(e,t,r)=>{"use strict";r.d(t,{P:()=>c});var s=r(4986);let a="flexlog:v1",l="flexlog:device-id",i=null,n=null;async function o(e){1;try{await fetch("/api/storage/snapshot",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({deviceId:function(){try{let e=localStorage.getItem(l);if(e)return e;return e="undefined"!=typeof crypto&&"randomUUID"in crypto?crypto.randomUUID():Math.random().toString(36).slice(2),localStorage.setItem(l,e),e}catch(e){return"fallback-device"}}(),state:e})})}catch(e){console.warn("Failed to sync Supabase snapshot",e)}}function d(){return{units:"lb",selectedDate:(0,s.GP)(new Date,"yyyy-MM-dd"),onboarding:null,targets:null,logs:{},workoutDays:[],indicators:{},strengthTrackerEnabled:!0,bodyweightOverride:null,weightLogs:{}}}function c(){let e=()=>(function(){try{let e=localStorage.getItem(a);if(!e)return d();let t=JSON.parse(e);return{...d(),...t}}catch(e){return d()}})(),t=t=>{var r;let s=t(e());return localStorage.setItem(a,JSON.stringify(s)),r=s,i=JSON.parse(JSON.stringify(r)),n||(n=window.setTimeout(()=>{n=null,i&&o(i).catch(()=>{})},1e3)),s};return{exportAll:()=>e(),clearAll:()=>localStorage.removeItem(a),getUnits:()=>e().units,setUnits:e=>t(t=>({...t,units:e})),getSelectedDate:()=>e().selectedDate,setSelectedDate:e=>t(t=>({...t,selectedDate:e})),getOnboarding:()=>e().onboarding,setOnboarding:e=>t(t=>({...t,onboarding:e})),getTargets:()=>e().targets,setTargets:e=>t(t=>({...t,targets:e})),getDailyLog:t=>{var r;return null!=(r=e().logs[t])?r:{date:t,mealGroups:[]}},setDailyLog:e=>t(t=>({...t,logs:{...t.logs,[e.date]:e},indicators:{...t.indicators,[e.date]:"dot"}})),addFoodItem:(e,r,s)=>t(t=>{var a;let l=null!=(a=t.logs[e])?a:{date:e,mealGroups:[]},i=l.mealGroups.map(e=>e.id===r?{...e,items:[...e.items,s]}:e),n={...l,mealGroups:i};return{...t,logs:{...t.logs,[e]:n},indicators:{...t.indicators,[e]:"dot"}}}),getDayIndicator:t=>{var r;return null!=(r=e().indicators[t])?r:"none"},getWorkoutDays:()=>e().workoutDays,setWorkoutDays:e=>t(t=>({...t,workoutDays:e})),getStrengthTrackerEnabled:()=>{var t;return null==(t=e().strengthTrackerEnabled)||t},setStrengthTrackerEnabled:e=>t(t=>({...t,strengthTrackerEnabled:e})),getBodyweightOverride:()=>{var t;return null!=(t=e().bodyweightOverride)?t:null},setBodyweightOverride:e=>t(t=>({...t,bodyweightOverride:e})),bumpWorkoutIndicator:e=>t(t=>({...t,indicators:{...t.indicators,[e]:"dot"}})),syncSnapshotsNow:()=>o(e()),getWeightLogs:()=>{var t;return null!=(t=e().weightLogs)?t:{}},setWeightLog:(e,r)=>t(t=>({...t,weightLogs:{...t.weightLogs,[e]:r}})),removeWeightLog:e=>t(t=>{let r={...t.weightLogs};return delete r[e],{...t,weightLogs:r}})}}},3698:(e,t,r)=>{"use strict";r.d(t,{l:()=>l});var s=r(5155),a=r(4269);function l(e){let{label:t,value:r,onChange:l,options:i,className:n,disabled:o}=e;return(0,s.jsxs)("label",{className:(0,a.cn)("block space-y-2",n,o&&"opacity-60"),children:[t?(0,s.jsx)("div",{className:"text-[10px] uppercase tracking-[0.35em] text-white/60",children:t}):null,(0,s.jsx)("select",{disabled:o,className:(0,a.cn)("w-full rounded-2xl border border-white/10 bg-white/10 px-4 py-3 text-sm text-white outline-none transition focus:border-white/40",o&&"cursor-not-allowed opacity-70"),value:r,onChange:e=>l(e.target.value),children:i.map(e=>(0,s.jsx)("option",{value:e.value,children:e.label},e.value))})]})}r(2115)},4269:(e,t,r)=>{"use strict";r.d(t,{cn:()=>l,s:()=>i});var s=r(2821),a=r(5889);function l(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.QP)((0,s.$)(t))}function i(e,t){let r;return function(){for(var s=arguments.length,a=Array(s),l=0;l<s;l++)a[l]=arguments[l];clearTimeout(r),r=setTimeout(()=>e(...a),t)}}},4734:(e,t,r)=>{"use strict";r.d(t,{l:()=>o,o:()=>d});var s=r(5155),a=r(2115),l=r(1408),i=r(4486);let n=(0,a.createContext)(null);function o(){let[e,t]=(0,a.useState)([]),r=(0,a.useMemo)(()=>({push:e=>{let r={...e,id:crypto.randomUUID()};t(e=>[...e,r]),setTimeout(()=>{t(e=>e.filter(e=>e.id!==r.id))},2600)}}),[]);return(0,a.useEffect)(()=>{window.__flexlog_toast=r},[r]),(0,s.jsx)(n.Provider,{value:r,children:(0,s.jsx)("div",{className:"pointer-events-none fixed right-4 top-4 z-[100] w-[340px] max-w-[calc(100vw-2rem)] space-y-2",children:(0,s.jsx)(l.N,{children:e.map(e=>(0,s.jsx)(i.P.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:["pointer-events-auto rounded-2xl border p-3 backdrop-blur","success"===e.type&&"border-emerald-900/60 bg-emerald-950/40","error"===e.type&&"border-red-900/60 bg-red-950/40","info"===e.type&&"border-zinc-800 bg-zinc-950/60"].join(" "),children:(0,s.jsx)("div",{className:"text-sm text-zinc-100",children:e.message})},e.id))})})})}let d={success:e=>{var t;return null==(t=window.__flexlog_toast)?void 0:t.push({type:"success",message:e})},error:e=>{var t;return null==(t=window.__flexlog_toast)?void 0:t.push({type:"error",message:e})},info:e=>{var t;return null==(t=window.__flexlog_toast)?void 0:t.push({type:"info",message:e})}}},5590:(e,t,r)=>{"use strict";r.d(t,{p:()=>l});var s=r(5155);r(2115);var a=r(4269);function l(e){let{label:t,className:r,disabled:l,...i}=e;return(0,s.jsxs)("label",{className:(0,a.cn)("block space-y-2",r,l&&"opacity-60"),children:[t?(0,s.jsx)("div",{className:"text-[10px] uppercase tracking-[0.35em] text-white/60",children:t}):null,(0,s.jsx)("input",{disabled:l,className:(0,a.cn)("w-full rounded-2xl border border-white/10 bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 transition focus:border-white/40 focus:outline-none",l&&"cursor-not-allowed opacity-70"),...i})]})}},5795:(e,t,r)=>{"use strict";r.d(t,{V:()=>n});var s=r(5155),a=r(2115),l=r(4486),i=r(4269);function n(e){let{title:t,subtitle:r,right:n,className:o}=e,[d,c]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{let e=()=>c(window.scrollY>8);return e(),window.addEventListener("scroll",e,{passive:!0}),()=>window.removeEventListener("scroll",e)},[]),(0,s.jsx)(l.P.div,{className:(0,i.cn)("sticky top-0 z-30 rounded-3xl border border-white/10 bg-white/5 px-4 py-4 backdrop-blur-xl shadow-[0_20px_60px_rgba(2,4,13,0.55)]",d?"border-white/15 bg-white/10":"",o),animate:{paddingTop:d?12:16,paddingBottom:d?12:16},transition:{duration:.18},children:(0,s.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-zinc-400",children:r}),(0,s.jsx)("div",{className:"text-xl font-semibold tracking-tight",children:t})]}),n?(0,s.jsx)("div",{children:n}):null]})})}},6489:(e,t,r)=>{Promise.resolve().then(r.bind(r,2417))},7972:(e,t,r)=>{"use strict";r.d(t,{Z:()=>l});var s=r(5155);r(2115);var a=r(4269);function l(e){let{className:t,children:r}=e;return(0,s.jsx)("div",{className:(0,a.cn)("w-full rounded-[28px] border border-white/10 bg-white/5 p-5 shadow-[0_30px_80px_rgba(2,4,13,0.65)] backdrop-blur-xl transition-colors duration-200 hover:border-white/20 sm:p-6",t),children:r})}}},e=>{e.O(0,[909,825,619,986,441,255,358],()=>e(e.s=6489)),_N_E=e.O()}]);