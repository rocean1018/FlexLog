(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[566],{605:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>m});var l=a(5155),r=a(2115),n=a(7972),s=a(1166),i=a(5590),o=a(3698),c=a(4269);function d(e){let{label:t,value:a,onChange:r,tabs:n}=e;return(0,l.jsxs)("div",{children:[t?(0,l.jsx)("div",{className:"text-sm text-zinc-400",children:t}):null,(0,l.jsx)("div",{className:"mt-2 inline-flex rounded-2xl border border-zinc-800 bg-zinc-950/40 p-1",children:n.map(e=>(0,l.jsx)("button",{onClick:()=>r(e.value),className:(0,c.cn)("rounded-2xl px-3 py-2 text-sm transition",a===e.value?"bg-zinc-900/70 text-white":"text-zinc-400 hover:text-zinc-200"),children:e.label},e.value))})]})}let u={sedentary:1.2,light:1.375,moderate:1.55,very:1.725,athlete:1.9};var g=a(3449),h=a(4734);function m(){var e,t,a,c,m,v,x,b,y,f,w,j,N,S,_,k,O,I,M;let C=(0,g.Pj)(),[z,D]=(0,r.useState)(null!=(f=C.getUnits())?f:"lb"),[T,U]=(0,r.useState)(null!=(w=null==(e=C.getOnboarding())?void 0:e.sex)?w:"male"),[J,L]=(0,r.useState)(null!=(j=null==(t=C.getOnboarding())?void 0:t.age)?j:18),[E,F]=(0,r.useState)(null!=(N=null==(a=C.getOnboarding())?void 0:a.heightCm)?N:175),[G,P]=(0,r.useState)(null!=(S=null==(c=C.getOnboarding())?void 0:c.weight)?S:160),[A,W]=(0,r.useState)(null!=(_=null==(m=C.getOnboarding())?void 0:m.activity)?_:"moderate"),[Z,Y]=(0,r.useState)(null!=(k=null==(v=C.getOnboarding())?void 0:v.goalMode)?k:"simple"),[q,R]=(0,r.useState)(null!=(O=null==(x=C.getOnboarding())?void 0:x.simpleGoal)?O:"lose"),[X,B]=(0,r.useState)(null!=(I=null==(b=C.getOnboarding())?void 0:b.percent)?I:-15),[H,V]=(0,r.useState)(null!=(M=null==(y=C.getOnboarding())?void 0:y.rate)?M:"lb"===z?.75:.35),$=(0,r.useMemo)(()=>(function(e){var t,a,l,r;let n=(t=e.units,a=e.weight,"kg"===t?a:.45359237*a),s=(l=e.sex,r=e.age,(10*n+6.25*e.heightCm-5*r+("male"===l?5:-161))*u[e.activity]),i=s;if("percent"===e.goalMode)i=s*(1+e.percent/100);else if("simple"===e.goalMode)i=s*(1+("lose"===e.simpleGoal?-.15:.1*("gain"===e.simpleGoal)));else if("rate"===e.goalMode){let t="lb"===e.units?3500:7700;i=s-e.rate*t/7}let o=n*(1.8+.2*(i<s)),c=Math.max(.8*n,45),d=Math.max(0,(i-4*o-9*c)/4);return{tdee:Math.round(s),targets:{calories:Math.round(i),protein_g:Math.round(o),carbs_g:Math.round(d),fat_g:Math.round(c)}}})({units:z,sex:T,age:J,heightCm:E,weight:G,activity:A,goalMode:Z,simpleGoal:q,percent:X,rate:H}),[z,T,J,E,G,A,Z,q,X,H]);return(0,l.jsxs)("div",{className:"mx-auto max-w-3xl px-4 py-8",children:[(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsx)("div",{className:"text-sm text-zinc-400",children:"Onboarding"}),(0,l.jsx)("h1",{className:"text-2xl font-semibold tracking-tight",children:"Set targets (TDEE + macros)"})]}),(0,l.jsxs)("div",{className:"grid gap-4",children:[(0,l.jsx)(n.Z,{children:(0,l.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,l.jsx)(o.l,{label:"Units",value:z,onChange:e=>{D(e),C.setUnits(e)},options:[{value:"lb",label:"Pounds (lb)"},{value:"kg",label:"Kilograms (kg)"}]}),(0,l.jsx)(o.l,{label:"Sex",value:T,onChange:e=>U(e),options:[{value:"male",label:"Male"},{value:"female",label:"Female"}]}),(0,l.jsx)(i.p,{label:"Age",type:"number",value:J,onChange:e=>L(Number(e.target.value))}),(0,l.jsx)(i.p,{label:"Height (cm)",type:"number",value:E,onChange:e=>F(Number(e.target.value))}),(0,l.jsx)(i.p,{label:"Weight (".concat(z,")"),type:"number",value:G,onChange:e=>P(Number(e.target.value))}),(0,l.jsx)(o.l,{label:"Activity",value:A,onChange:e=>W(e),options:[{value:"sedentary",label:"Sedentary"},{value:"light",label:"Light"},{value:"moderate",label:"Moderate"},{value:"very",label:"Very active"},{value:"athlete",label:"Athlete"}]})]})}),(0,l.jsxs)(n.Z,{children:[(0,l.jsx)(d,{label:"Goal mode",value:Z,onChange:e=>Y(e),tabs:[{value:"rate",label:"Rate-based"},{value:"percent",label:"% of TDEE"},{value:"simple",label:"Simple"}]}),(0,l.jsxs)("div",{className:"mt-4 grid gap-4 sm:grid-cols-2",children:["simple"===Z&&(0,l.jsx)(o.l,{label:"Goal",value:q,onChange:e=>R(e),options:[{value:"lose",label:"Lose"},{value:"maintain",label:"Maintain"},{value:"gain",label:"Gain"}]}),"percent"===Z&&(0,l.jsx)(i.p,{label:"Percent (negative = deficit)",type:"number",value:X,onChange:e=>B(Number(e.target.value))}),"rate"===Z&&(0,l.jsx)(i.p,{label:"Rate (".concat(z,"/week)"),type:"number",value:H,step:"0.05",onChange:e=>V(Number(e.target.value))})]}),(0,l.jsxs)("div",{className:"mt-6 grid gap-3 rounded-2xl bg-zinc-950/40 p-4 ring-1 ring-zinc-800",children:[(0,l.jsx)("div",{className:"text-sm text-zinc-400",children:"Preview targets"}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-3 sm:grid-cols-4",children:[(0,l.jsx)(p,{label:"Calories",value:$.targets.calories.toFixed(0)}),(0,l.jsx)(p,{label:"Protein (g)",value:$.targets.protein_g.toFixed(0)}),(0,l.jsx)(p,{label:"Carbs (g)",value:$.targets.carbs_g.toFixed(0)}),(0,l.jsx)(p,{label:"Fat (g)",value:$.targets.fat_g.toFixed(0)})]}),(0,l.jsx)("div",{className:"text-xs text-zinc-500",children:"Uses Mifflin-St Jeor BMR + activity multiplier. Macro defaults can be adjusted later in Settings."})]}),(0,l.jsx)("div",{className:"mt-5 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-end",children:(0,l.jsx)(s.$,{onClick:()=>{C.setOnboarding({units:z,sex:T,age:J,heightCm:E,weight:G,activity:A,goalMode:Z,simpleGoal:q,percent:X,rate:H}),C.setTargets($.targets),h.o.success("Targets saved. Head to your Daily Log.")},children:"Save targets"})})]})]})]})}function p(e){let{label:t,value:a}=e;return(0,l.jsxs)("div",{className:"rounded-2xl bg-zinc-900/40 p-3 ring-1 ring-zinc-800",children:[(0,l.jsx)("div",{className:"text-xs text-zinc-400",children:t}),(0,l.jsx)("div",{className:"text-lg font-semibold tracking-tight",children:a})]})}},905:(e,t,a)=>{Promise.resolve().then(a.bind(a,605))},1166:(e,t,a)=>{"use strict";a.d(t,{$:()=>n});var l=a(5155);a(2115);var r=a(4269);function n(e){let{className:t,variant:a="primary",size:n="md",...s}=e;return(0,l.jsx)("button",{className:(0,r.cn)("inline-flex items-center justify-center rounded-full font-semibold uppercase tracking-wide transition duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-sky-400 disabled:opacity-60","primary"===a&&"bg-gradient-to-r from-sky-400 via-fuchsia-500 to-emerald-400 text-white shadow-[0_15px_35px_rgba(8,47,73,0.45)] hover:opacity-90","secondary"===a&&"border border-white/15 bg-white/10 text-white shadow-[0_10px_25px_rgba(0,0,0,0.4)] hover:bg-white/20","ghost"===a&&"text-white/80 hover:text-white hover:bg-white/10","destructive"===a&&"bg-gradient-to-r from-rose-500 to-orange-500 text-white shadow-[0_15px_35px_rgba(127,29,29,0.45)] hover:opacity-90","sm"===n&&"px-3.5 py-1.5 text-[11px]","md"===n&&"px-4 py-2 text-sm","lg"===n&&"px-5 py-2.5 text-base",t),...s})}},1289:(e,t,a)=>{"use strict";a.d(t,{N:()=>s});var l=a(2373);let r="https://tosrqizgsvmqxgcmvrgm.supabase.co",n="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRvc3JxaXpnc3ZtcXhnY212cmdtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjYwNzg3NTYsImV4cCI6MjA4MTY1NDc1Nn0.3SjpqNotspin0hy4MztwG5uG_AFHSSdhiD47gqmc9G8",s=r&&n?(0,l.UU)(r,n,{auth:{detectSessionInUrl:!0,persistSession:!0}}):null},3449:(e,t,a)=>{"use strict";a.d(t,{P_:()=>h,Pj:()=>w,n4:()=>f});var l=a(1289),r=a(4986);let n="flexlog:v1",s="flexlog:device-id",i="user_snapshots",o=null,c=null,d=null,u=null,g=null;function h(e){g=e}function m(e){return JSON.parse(JSON.stringify(e))}async function p(e){1;try{await fetch("/api/storage/snapshot",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({deviceId:function(){try{let e=localStorage.getItem(s);if(e)return e;return e="undefined"!=typeof crypto&&"randomUUID"in crypto?crypto.randomUUID():Math.random().toString(36).slice(2),localStorage.setItem(s,e),e}catch(e){return"fallback-device"}}(),state:e})})}catch(e){console.warn("Failed to sync Supabase snapshot",e)}}async function v(e){if(g&&l.N)try{let{error:t}=await l.N.from(i).upsert({user_id:g,state:e,updated_at:new Date().toISOString()});t&&console.warn("Failed to sync user snapshot",t)}catch(e){console.warn("Failed to sync user snapshot",e)}}function x(e){1;if(g&&l.N){if(d=m(e),u)return;u=window.setTimeout(()=>{u=null,d&&v(d).catch(()=>{})},1e3);return}o=m(e),c||(c=window.setTimeout(()=>{c=null,o&&p(o).catch(()=>{})},1e3))}function b(){return{units:"lb",selectedDate:(0,r.GP)(new Date,"yyyy-MM-dd"),onboarding:null,targets:null,logs:{},workoutDays:[],indicators:{},strengthTrackerEnabled:!0,bodyweightOverride:null,weightLogs:{}}}function y(){try{let e=localStorage.getItem(n);if(!e)return b();let t=JSON.parse(e);return{...b(),...t}}catch(e){return b()}}async function f(e){if(!l.N)return{synced:!1,reason:"supabase_not_configured"};g=e;let{data:t,error:a}=await l.N.from(i).select("state").eq("user_id",e).maybeSingle();return a?(console.warn("Failed to fetch user snapshot",a),{synced:!1,reason:"fetch_error"}):(null==t?void 0:t.state)?(localStorage.setItem(n,JSON.stringify(t.state)),x(t.state),{synced:!0,reason:"loaded_remote"}):(x(y()),{synced:!0,reason:"no_remote"})}function w(){let e=()=>y(),t=t=>{let a=t(e());return localStorage.setItem(n,JSON.stringify(a)),x(a),a};return{exportAll:()=>e(),clearAll:()=>localStorage.removeItem(n),getUnits:()=>e().units,setUnits:e=>t(t=>({...t,units:e})),getSelectedDate:()=>e().selectedDate,setSelectedDate:e=>t(t=>({...t,selectedDate:e})),getOnboarding:()=>e().onboarding,setOnboarding:e=>t(t=>({...t,onboarding:e})),getTargets:()=>e().targets,setTargets:e=>t(t=>({...t,targets:e})),getDailyLog:t=>{var a;return null!=(a=e().logs[t])?a:{date:t,mealGroups:[]}},setDailyLog:e=>t(t=>({...t,logs:{...t.logs,[e.date]:e},indicators:{...t.indicators,[e.date]:"dot"}})),addFoodItem:(e,a,l)=>t(t=>{var r;let n=null!=(r=t.logs[e])?r:{date:e,mealGroups:[]},s=n.mealGroups.map(e=>e.id===a?{...e,items:[...e.items,l]}:e),i={...n,mealGroups:s};return{...t,logs:{...t.logs,[e]:i},indicators:{...t.indicators,[e]:"dot"}}}),getDayIndicator:t=>{var a;return null!=(a=e().indicators[t])?a:"none"},getWorkoutDays:()=>e().workoutDays,setWorkoutDays:e=>t(t=>({...t,workoutDays:e})),getStrengthTrackerEnabled:()=>{var t;return null==(t=e().strengthTrackerEnabled)||t},setStrengthTrackerEnabled:e=>t(t=>({...t,strengthTrackerEnabled:e})),getBodyweightOverride:()=>{var t;return null!=(t=e().bodyweightOverride)?t:null},setBodyweightOverride:e=>t(t=>({...t,bodyweightOverride:e})),bumpWorkoutIndicator:e=>t(t=>({...t,indicators:{...t.indicators,[e]:"dot"}})),syncSnapshotsNow:()=>p(e()),getWeightLogs:()=>{var t;return null!=(t=e().weightLogs)?t:{}},setWeightLog:(e,a)=>t(t=>({...t,weightLogs:{...t.weightLogs,[e]:a}})),removeWeightLog:e=>t(t=>{let a={...t.weightLogs};return delete a[e],{...t,weightLogs:a}})}}},3698:(e,t,a)=>{"use strict";a.d(t,{l:()=>n});var l=a(5155),r=a(4269);function n(e){let{label:t,value:a,onChange:n,options:s,className:i,disabled:o}=e;return(0,l.jsxs)("label",{className:(0,r.cn)("block space-y-2",i,o&&"opacity-60"),children:[t?(0,l.jsx)("div",{className:"text-[10px] uppercase tracking-[0.35em] text-white/60",children:t}):null,(0,l.jsx)("select",{disabled:o,className:(0,r.cn)("w-full rounded-2xl border border-white/10 bg-white/10 px-4 py-3 text-sm text-white outline-none transition focus:border-white/40",o&&"cursor-not-allowed opacity-70"),value:a,onChange:e=>n(e.target.value),children:s.map(e=>(0,l.jsx)("option",{value:e.value,children:e.label},e.value))})]})}a(2115)},4269:(e,t,a)=>{"use strict";a.d(t,{cn:()=>n,s:()=>s});var l=a(2821),r=a(5889);function n(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,r.QP)((0,l.$)(t))}function s(e,t){let a;return function(){for(var l=arguments.length,r=Array(l),n=0;n<l;n++)r[n]=arguments[n];clearTimeout(a),a=setTimeout(()=>e(...r),t)}}},4734:(e,t,a)=>{"use strict";a.d(t,{l:()=>o,o:()=>c});var l=a(5155),r=a(2115),n=a(1408),s=a(4486);let i=(0,r.createContext)(null);function o(){let[e,t]=(0,r.useState)([]),a=(0,r.useMemo)(()=>({push:e=>{let a={...e,id:crypto.randomUUID()};t(e=>[...e,a]),setTimeout(()=>{t(e=>e.filter(e=>e.id!==a.id))},2600)}}),[]);return(0,r.useEffect)(()=>{window.__flexlog_toast=a},[a]),(0,l.jsx)(i.Provider,{value:a,children:(0,l.jsx)("div",{className:"pointer-events-none fixed right-4 top-4 z-[100] w-[340px] max-w-[calc(100vw-2rem)] space-y-2",children:(0,l.jsx)(n.N,{children:e.map(e=>(0,l.jsx)(s.P.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:["pointer-events-auto rounded-2xl border p-3 backdrop-blur","success"===e.type&&"border-emerald-900/60 bg-emerald-950/40","error"===e.type&&"border-red-900/60 bg-red-950/40","info"===e.type&&"border-zinc-800 bg-zinc-950/60"].join(" "),children:(0,l.jsx)("div",{className:"text-sm text-zinc-100",children:e.message})},e.id))})})})}let c={success:e=>{var t;return null==(t=window.__flexlog_toast)?void 0:t.push({type:"success",message:e})},error:e=>{var t;return null==(t=window.__flexlog_toast)?void 0:t.push({type:"error",message:e})},info:e=>{var t;return null==(t=window.__flexlog_toast)?void 0:t.push({type:"info",message:e})}}},5590:(e,t,a)=>{"use strict";a.d(t,{p:()=>n});var l=a(5155);a(2115);var r=a(4269);function n(e){let{label:t,className:a,disabled:n,...s}=e;return(0,l.jsxs)("label",{className:(0,r.cn)("block space-y-2",a,n&&"opacity-60"),children:[t?(0,l.jsx)("div",{className:"text-[10px] uppercase tracking-[0.35em] text-white/60",children:t}):null,(0,l.jsx)("input",{disabled:n,className:(0,r.cn)("w-full rounded-2xl border border-white/10 bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 transition focus:border-white/40 focus:outline-none",n&&"cursor-not-allowed opacity-70"),...s})]})}},7972:(e,t,a)=>{"use strict";a.d(t,{Z:()=>n});var l=a(5155);a(2115);var r=a(4269);function n(e){let{className:t,children:a}=e;return(0,l.jsx)("div",{className:(0,r.cn)("w-full rounded-[28px] border border-white/10 bg-white/5 p-5 shadow-[0_30px_80px_rgba(2,4,13,0.65)] backdrop-blur-xl transition-colors duration-200 hover:border-white/20 sm:p-6",t),children:a})}}},e=>{e.O(0,[909,970,441,255,358],()=>e(e.s=905)),_N_E=e.O()}]);