(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[196],{63:(e,t,r)=>{"use strict";var a=r(7260);r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useSearchParams")&&r.d(t,{useSearchParams:function(){return a.useSearchParams}})},1166:(e,t,r)=>{"use strict";r.d(t,{$:()=>l});var a=r(5155);r(2115);var s=r(4269);function l(e){let{className:t,variant:r="primary",size:l="md",...n}=e;return(0,a.jsx)("button",{className:(0,s.cn)("inline-flex items-center justify-center rounded-full font-semibold uppercase tracking-wide transition duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-sky-400 disabled:opacity-60","primary"===r&&"bg-gradient-to-r from-sky-400 via-fuchsia-500 to-emerald-400 text-white shadow-[0_15px_35px_rgba(8,47,73,0.45)] hover:opacity-90","secondary"===r&&"border border-white/15 bg-white/10 text-white shadow-[0_10px_25px_rgba(0,0,0,0.4)] hover:bg-white/20","ghost"===r&&"text-white/80 hover:text-white hover:bg-white/10","destructive"===r&&"bg-gradient-to-r from-rose-500 to-orange-500 text-white shadow-[0_15px_35px_rgba(127,29,29,0.45)] hover:opacity-90","sm"===l&&"px-3.5 py-1.5 text-[11px]","md"===l&&"px-4 py-2 text-sm","lg"===l&&"px-5 py-2.5 text-base",t),...n})}},1847:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var a=r(2115);let s=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let n=(0,a.forwardRef)((e,t)=>{let{color:r="currentColor",size:n=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:c="",children:d,iconNode:u,...m}=e;return(0,a.createElement)("svg",{ref:t,...l,width:n,height:n,stroke:r,strokeWidth:o?24*Number(i)/Number(n):i,className:s("lucide",c),...m},[...u.map(e=>{let[t,r]=e;return(0,a.createElement)(t,r)}),...Array.isArray(d)?d:[d]])}),i=(e,t)=>{let r=(0,a.forwardRef)((r,l)=>{let{className:i,...o}=r;return(0,a.createElement)(n,{ref:l,iconNode:t,className:s("lucide-".concat(e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),i),...o})});return r.displayName="".concat(e),r}},2685:(e,t,r)=>{Promise.resolve().then(r.bind(r,7005))},3449:(e,t,r)=>{"use strict";r.d(t,{P:()=>d});var a=r(4986);let s="flexlog:v1",l="flexlog:device-id",n=null,i=null;async function o(e){1;try{await fetch("/api/storage/snapshot",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({deviceId:function(){try{let e=localStorage.getItem(l);if(e)return e;return e="undefined"!=typeof crypto&&"randomUUID"in crypto?crypto.randomUUID():Math.random().toString(36).slice(2),localStorage.setItem(l,e),e}catch(e){return"fallback-device"}}(),state:e})})}catch(e){console.warn("Failed to sync Supabase snapshot",e)}}function c(){return{units:"lb",selectedDate:(0,a.GP)(new Date,"yyyy-MM-dd"),onboarding:null,targets:null,logs:{},workoutDays:[],indicators:{},strengthTrackerEnabled:!0,bodyweightOverride:null,weightLogs:{}}}function d(){let e=()=>(function(){try{let e=localStorage.getItem(s);if(!e)return c();let t=JSON.parse(e);return{...c(),...t}}catch(e){return c()}})(),t=t=>{var r;let a=t(e());return localStorage.setItem(s,JSON.stringify(a)),r=a,n=JSON.parse(JSON.stringify(r)),i||(i=window.setTimeout(()=>{i=null,n&&o(n).catch(()=>{})},1e3)),a};return{exportAll:()=>e(),clearAll:()=>localStorage.removeItem(s),getUnits:()=>e().units,setUnits:e=>t(t=>({...t,units:e})),getSelectedDate:()=>e().selectedDate,setSelectedDate:e=>t(t=>({...t,selectedDate:e})),getOnboarding:()=>e().onboarding,setOnboarding:e=>t(t=>({...t,onboarding:e})),getTargets:()=>e().targets,setTargets:e=>t(t=>({...t,targets:e})),getDailyLog:t=>{var r;return null!=(r=e().logs[t])?r:{date:t,mealGroups:[]}},setDailyLog:e=>t(t=>({...t,logs:{...t.logs,[e.date]:e},indicators:{...t.indicators,[e.date]:"dot"}})),addFoodItem:(e,r,a)=>t(t=>{var s;let l=null!=(s=t.logs[e])?s:{date:e,mealGroups:[]},n=l.mealGroups.map(e=>e.id===r?{...e,items:[...e.items,a]}:e),i={...l,mealGroups:n};return{...t,logs:{...t.logs,[e]:i},indicators:{...t.indicators,[e]:"dot"}}}),getDayIndicator:t=>{var r;return null!=(r=e().indicators[t])?r:"none"},getWorkoutDays:()=>e().workoutDays,setWorkoutDays:e=>t(t=>({...t,workoutDays:e})),getStrengthTrackerEnabled:()=>{var t;return null==(t=e().strengthTrackerEnabled)||t},setStrengthTrackerEnabled:e=>t(t=>({...t,strengthTrackerEnabled:e})),getBodyweightOverride:()=>{var t;return null!=(t=e().bodyweightOverride)?t:null},setBodyweightOverride:e=>t(t=>({...t,bodyweightOverride:e})),bumpWorkoutIndicator:e=>t(t=>({...t,indicators:{...t.indicators,[e]:"dot"}})),syncSnapshotsNow:()=>o(e()),getWeightLogs:()=>{var t;return null!=(t=e().weightLogs)?t:{}},setWeightLog:(e,r)=>t(t=>({...t,weightLogs:{...t.weightLogs,[e]:r}})),removeWeightLog:e=>t(t=>{let r={...t.weightLogs};return delete r[e],{...t,weightLogs:r}})}}},3698:(e,t,r)=>{"use strict";r.d(t,{l:()=>l});var a=r(5155),s=r(4269);function l(e){let{label:t,value:r,onChange:l,options:n,className:i,disabled:o}=e;return(0,a.jsxs)("label",{className:(0,s.cn)("block space-y-2",i,o&&"opacity-60"),children:[t?(0,a.jsx)("div",{className:"text-[10px] uppercase tracking-[0.35em] text-white/60",children:t}):null,(0,a.jsx)("select",{disabled:o,className:(0,s.cn)("w-full rounded-2xl border border-white/10 bg-white/10 px-4 py-3 text-sm text-white outline-none transition focus:border-white/40",o&&"cursor-not-allowed opacity-70"),value:r,onChange:e=>l(e.target.value),children:n.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))})]})}r(2115)},4269:(e,t,r)=>{"use strict";r.d(t,{cn:()=>l,s:()=>n});var a=r(2821),s=r(5889);function l(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.QP)((0,a.$)(t))}function n(e,t){let r;return function(){for(var a=arguments.length,s=Array(a),l=0;l<a;l++)s[l]=arguments[l];clearTimeout(r),r=setTimeout(()=>e(...s),t)}}},4734:(e,t,r)=>{"use strict";r.d(t,{l:()=>o,o:()=>c});var a=r(5155),s=r(2115),l=r(1408),n=r(4486);let i=(0,s.createContext)(null);function o(){let[e,t]=(0,s.useState)([]),r=(0,s.useMemo)(()=>({push:e=>{let r={...e,id:crypto.randomUUID()};t(e=>[...e,r]),setTimeout(()=>{t(e=>e.filter(e=>e.id!==r.id))},2600)}}),[]);return(0,s.useEffect)(()=>{window.__flexlog_toast=r},[r]),(0,a.jsx)(i.Provider,{value:r,children:(0,a.jsx)("div",{className:"pointer-events-none fixed right-4 top-4 z-[100] w-[340px] max-w-[calc(100vw-2rem)] space-y-2",children:(0,a.jsx)(l.N,{children:e.map(e=>(0,a.jsx)(n.P.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.18},className:["pointer-events-auto rounded-2xl border p-3 backdrop-blur","success"===e.type&&"border-emerald-900/60 bg-emerald-950/40","error"===e.type&&"border-red-900/60 bg-red-950/40","info"===e.type&&"border-zinc-800 bg-zinc-950/60"].join(" "),children:(0,a.jsx)("div",{className:"text-sm text-zinc-100",children:e.message})},e.id))})})})}let c={success:e=>{var t;return null==(t=window.__flexlog_toast)?void 0:t.push({type:"success",message:e})},error:e=>{var t;return null==(t=window.__flexlog_toast)?void 0:t.push({type:"error",message:e})},info:e=>{var t;return null==(t=window.__flexlog_toast)?void 0:t.push({type:"info",message:e})}}},5590:(e,t,r)=>{"use strict";r.d(t,{p:()=>l});var a=r(5155);r(2115);var s=r(4269);function l(e){let{label:t,className:r,disabled:l,...n}=e;return(0,a.jsxs)("label",{className:(0,s.cn)("block space-y-2",r,l&&"opacity-60"),children:[t?(0,a.jsx)("div",{className:"text-[10px] uppercase tracking-[0.35em] text-white/60",children:t}):null,(0,a.jsx)("input",{disabled:l,className:(0,s.cn)("w-full rounded-2xl border border-white/10 bg-white/10 px-4 py-3 text-sm text-white placeholder:text-white/40 transition focus:border-white/40 focus:outline-none",l&&"cursor-not-allowed opacity-70"),...n})]})}},5795:(e,t,r)=>{"use strict";r.d(t,{V:()=>i});var a=r(5155),s=r(2115),l=r(4486),n=r(4269);function i(e){let{title:t,subtitle:r,right:i,className:o}=e,[c,d]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{let e=()=>d(window.scrollY>8);return e(),window.addEventListener("scroll",e,{passive:!0}),()=>window.removeEventListener("scroll",e)},[]),(0,a.jsx)(l.P.div,{className:(0,n.cn)("sticky top-0 z-30 rounded-3xl border border-white/10 bg-white/5 px-4 py-4 backdrop-blur-xl shadow-[0_20px_60px_rgba(2,4,13,0.55)]",c?"border-white/15 bg-white/10":"",o),animate:{paddingTop:c?12:16,paddingBottom:c?12:16},transition:{duration:.18},children:(0,a.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-zinc-400",children:r}),(0,a.jsx)("div",{className:"text-xl font-semibold tracking-tight",children:t})]}),i?(0,a.jsx)("div",{children:i}):null]})})}},6191:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(1847).A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},7005:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>_});var a=r(5155),s=r(2115),l=r(2619),n=r.n(l),i=r(63),o=r(5795),c=r(7972),d=r(1166),u=r(5590),m=r(3698),h=r(3449),g=r(4734),p=r(4269),x=r(1847);let v=(0,x.A)("ScanLine",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M7 12h10",key:"b7w52i"}]]);var b=r(6191);let f=(0,x.A)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),w=(0,x.A)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),y=(0,x.A)("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]),j=(0,x.A)("ImagePlus",[["path",{d:"M16 5h6",key:"1vod17"}],["path",{d:"M19 2v6",key:"4bpg5p"}],["path",{d:"M21 11.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7.5",key:"1ue2ih"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}]]);function N(){return globalThis.BarcodeDetector}function k(e){let{value:t,onValueChange:r,onDetected:l,disabled:n}=e,i=(0,s.useRef)(null),o=(0,s.useRef)(null),c=(0,s.useRef)(null),[m,h]=(0,s.useState)(!1),[p,x]=(0,s.useState)(null);async function v(){if(c.current&&(cancelAnimationFrame(c.current),c.current=null),o.current){for(let e of o.current.getTracks())e.stop();o.current=null}h(!1)}async function b(){if(!p)return void g.o.error("Camera barcode scanning isn't supported in this browser.");if(!n)try{let e=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});o.current=e,i.current&&(i.current.srcObject=e,await i.current.play()),h(!0);let t=new(N())({formats:["ean_13","ean_8","upc_a","upc_e","code_128"]}),a=async()=>{try{if(!i.current)return;let e=await t.detect(i.current);if(e&&e.length){let t=e[0].rawValue;if(t){r(t),l(t),await v();return}}}catch(e){}c.current=requestAnimationFrame(a)};c.current=requestAnimationFrame(a)}catch(e){g.o.error("Couldn't access camera. Check permissions and try again."),await v()}}async function f(e){let t=N();if(!t)return void g.o.error("Image barcode scanning isn't supported in this browser.");try{let a=await createImageBitmap(e),s=new t({formats:["ean_13","ean_8","upc_a","upc_e","code_128"]}),n=await s.detect(a);if(n&&n.length){let e=n[0].rawValue;if(e){r(e),l(e);return}}g.o.error("No barcode found in that image.")}catch(e){g.o.error("Image scan failed.")}}return(0,s.useEffect)(()=>{var e,t;x(!!N()&&!!(null==(t=navigator)||null==(e=t.mediaDevices)?void 0:e.getUserMedia))},[]),(0,s.useEffect)(()=>()=>{v()},[]),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(u.p,{placeholder:"UPC/EAN",value:t,onChange:e=>r(e.target.value),disabled:n}),(0,a.jsx)(d.$,{onClick:()=>l(t),disabled:n,children:"Lookup"})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,a.jsx)(d.$,{variant:"secondary",onClick:m?v:b,disabled:n||!p,children:m?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(w,{className:"mr-2 h-4 w-4"})," Stop camera"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(y,{className:"mr-2 h-4 w-4"})," Scan with camera"]})}),(0,a.jsxs)("label",{className:"inline-flex cursor-pointer items-center"+(n?" pointer-events-none opacity-50":""),title:"Upload a photo of a barcode",children:[(0,a.jsx)("span",{className:"sr-only",children:"Scan from photo"}),(0,a.jsx)("input",{type:"file",accept:"image/*",capture:"environment",className:"hidden",onChange:e=>{var t;let r=null==(t=e.target.files)?void 0:t[0];r&&f(r),e.currentTarget.value=""}}),(0,a.jsxs)("span",{className:"inline-flex h-10 items-center justify-center rounded-2xl bg-zinc-900/60 px-4 text-sm font-medium text-zinc-100 ring-1 ring-zinc-800 transition hover:bg-zinc-900",children:[(0,a.jsx)(j,{className:"mr-2 h-4 w-4"})," Scan photo"]})]})]}),m?(0,a.jsx)("div",{className:"overflow-hidden rounded-2xl ring-1 ring-zinc-800",children:(0,a.jsx)("video",{ref:i,className:"aspect-video w-full bg-black",playsInline:!0,muted:!0})}):null,null===p?(0,a.jsx)("div",{className:"text-xs text-zinc-500",children:"Checking camera support…"}):p?(0,a.jsx)("div",{className:"text-xs text-zinc-500",children:"Tip: camera scanning works best on HTTPS or localhost."}):(0,a.jsx)("div",{className:"text-xs text-zinc-500",children:"Camera scanning requires a Chromium-based browser (or BarcodeDetector support). Manual entry still works."})]})}function _(){return(0,a.jsx)(s.Suspense,{fallback:(0,a.jsx)("div",{className:"p-6 text-center text-sm text-white/70",children:"Loading foods…"}),children:(0,a.jsx)(S,{})})}function S(){var e,t,r;let l=(0,h.P)(),x=(0,i.useSearchParams)(),w=null!=(t=l.getSelectedDate())?t:new Date().toISOString().slice(0,10),y=l.getDailyLog(w),[j,N]=(0,s.useState)(null!=(r=null==(e=y.mealGroups[0])?void 0:e.id)?r:""),_=x.get("group");(0,s.useEffect)(()=>{var e;if(_&&y.mealGroups.some(e=>e.id===_))return void N(_);!j&&(null==(e=y.mealGroups[0])?void 0:e.id)&&N(y.mealGroups[0].id)},[_,y.mealGroups,j]);let S=(0,s.useMemo)(()=>y.mealGroups.map(e=>({value:e.id,label:e.name})),[y.mealGroups]),[A,D]=(0,s.useState)(""),[F,I]=(0,s.useState)([]),[M,P]=(0,s.useState)(!1),[T,L]=(0,s.useState)(""),[z,E]=(0,s.useState)(null),[O,U]=(0,s.useState)({name:"",calories:0,protein_g:0,carbs_g:0,fat_g:0}),G=(0,s.useMemo)(()=>(0,p.s)(async e=>{let t=e.trim();if(!t)return void I([]);P(!0);try{var r;let e=await fetch("/api/foods/search?q=".concat(encodeURIComponent(t))),a=await e.json();I(null!=(r=a.results)?r:[])}catch(e){I([])}finally{P(!1)}},250),[]);async function W(e){let t=(null!=e?e:T).trim();if(t){E(null),P(!0);try{var r;let e=await fetch("/api/foods/barcode?code=".concat(encodeURIComponent(t))),a=await e.json();E(null!=(r=a.result)?r:null),a.result||g.o.error("No product found for that barcode. Try manual add.")}catch(e){g.o.error("Barcode lookup failed. Try manual add.")}finally{P(!1)}}}function q(e){var t,r;let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(!j)return void g.o.error("Create a meal group first (Daily Log → Add meal group).");let s=Number.isFinite(a)&&a>0?a:1;l.addFoodItem(w,j,{id:crypto.randomUUID(),name:e.name,source:e.source,sourceId:e.sourceId,barcode:null!=(t=e.barcode)?t:null,qty:s,unit:null!=(r=e.unit)?r:"serving",calories:e.calories*s,protein_g:e.protein_g*s,carbs_g:e.carbs_g*s,fat_g:e.fat_g*s,createdAt:Date.now()}),g.o.success("Added to meal group.")}return(0,s.useEffect)(()=>{G(A)},[A,G]),(0,a.jsxs)("div",{className:"relative min-h-screen overflow-hidden bg-[#02040d] text-white",children:[(0,a.jsxs)("div",{className:"pointer-events-none absolute inset-0",children:[(0,a.jsx)("div",{className:"absolute -top-24 left-20 h-96 w-96 rounded-full bg-sky-500/10 blur-[160px]"}),(0,a.jsx)("div",{className:"absolute bottom-0 right-0 h-96 w-96 rounded-full bg-fuchsia-500/10 blur-[200px]"})]}),(0,a.jsxs)("div",{className:"relative mx-auto max-w-6xl px-4 py-10 space-y-8",children:[(0,a.jsx)(o.V,{title:"Foods",subtitle:"Search USDA • Scan OFF • Manual fallback",className:"border-white/10 bg-white/5",right:(0,a.jsx)(n(),{href:"/log",children:(0,a.jsx)(d.$,{variant:"secondary",children:"Back to log"})})}),(0,a.jsxs)("div",{className:"grid gap-6 lg:grid-cols-[360px,1fr]",children:[(0,a.jsxs)(c.Z,{className:"space-y-6 border-white/10 bg-white/5",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-[10px] uppercase tracking-[0.4em] text-white/60",children:"Add to"}),(0,a.jsx)("h2",{className:"mt-1 text-2xl font-semibold",children:"Today's log"}),(0,a.jsxs)("div",{className:"mt-4 grid gap-4 sm:grid-cols-2 lg:grid-cols-1",children:[(0,a.jsx)(u.p,{label:"Date",value:w,disabled:!0}),(0,a.jsx)(m.l,{label:"Meal group",value:j,onChange:N,options:S.length?S:[{value:"",label:"No meal groups yet"}]})]})]}),(0,a.jsxs)("div",{className:"rounded-[24px] border border-white/10 bg-gradient-to-br from-sky-500/10 via-transparent to-fuchsia-500/5 p-4 shadow-inner",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm font-semibold uppercase tracking-wide text-white/80",children:[(0,a.jsx)(v,{className:"h-4 w-4 text-sky-300"})," Barcode lookup (OFF)"]}),(0,a.jsx)("div",{className:"mt-3 rounded-2xl border border-dashed border-white/10 bg-black/30 p-3",children:(0,a.jsx)(k,{value:T,onValueChange:L,onDetected:e=>W(e),disabled:M})}),z?(0,a.jsx)("div",{className:"mt-3 rounded-2xl border border-white/10 bg-black/40 p-3",children:(0,a.jsx)(C,{food:z,onAdd:e=>q(z,e),compact:!0})}):(0,a.jsx)("p",{className:"mt-2 text-xs text-white/50",children:"Scan a barcode to auto-fill nutrition data."})]}),(0,a.jsxs)("div",{className:"rounded-[24px] border border-white/10 bg-black/30 p-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm font-semibold uppercase tracking-wide text-white/80",children:[(0,a.jsx)(b.A,{className:"h-4 w-4 text-emerald-300"})," Manual entry"]}),(0,a.jsxs)("div",{className:"mt-4 grid gap-3",children:[(0,a.jsx)(u.p,{label:"Name",value:O.name,onChange:e=>U(t=>({...t,name:e.target.value}))}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsx)(u.p,{label:"Calories",type:"number",value:O.calories,onChange:e=>U(t=>({...t,calories:Number(e.target.value)}))}),(0,a.jsx)(u.p,{label:"Protein (g)",type:"number",value:O.protein_g,onChange:e=>U(t=>({...t,protein_g:Number(e.target.value)}))}),(0,a.jsx)(u.p,{label:"Carbs (g)",type:"number",value:O.carbs_g,onChange:e=>U(t=>({...t,carbs_g:Number(e.target.value)}))}),(0,a.jsx)(u.p,{label:"Fat (g)",type:"number",value:O.fat_g,onChange:e=>U(t=>({...t,fat_g:Number(e.target.value)}))})]}),(0,a.jsx)(d.$,{onClick:function(){O.name.trim()&&(q({name:O.name.trim(),source:"CUSTOM",sourceId:null,calories:O.calories,protein_g:O.protein_g,carbs_g:O.carbs_g,fat_g:O.fat_g,unit:"serving"}),U({name:"",calories:0,protein_g:0,carbs_g:0,fat_g:0}))},className:"self-start",children:"Add custom food"})]})]})]}),(0,a.jsxs)(c.Z,{className:"border-white/10 bg-gradient-to-br from-[#050b18]/90 via-[#0c111f]/95 to-[#150b1a]/90",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-end sm:justify-between",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)(u.p,{label:"Search foods (USDA FDC)",placeholder:"e.g., chicken breast, oats, rice",value:A,onChange:e=>D(e.target.value)})}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-white/60",children:[(0,a.jsx)(f,{className:"h-4 w-4 text-sky-300"}),M?"Searching…":"".concat(F.length," results")]})]}),(0,a.jsxs)("div",{className:"mt-5 grid gap-3",children:[0===F.length&&A.trim()?(0,a.jsxs)("div",{className:"rounded-3xl border border-white/10 bg-black/30 p-6 text-sm text-white/70",children:["No results. Try a broader query or add a custom food.",(0,a.jsxs)("div",{className:"mt-2 text-xs text-white/50",children:["If you're running locally and always see 0 results, set ",(0,a.jsx)("span",{className:"text-white",children:"USDA_FDC_API_KEY"})," in"," ",(0,a.jsx)("span",{className:"text-white",children:".env.local"})," and restart the dev server."]})]}):null,F.map(e=>{var t;return(0,a.jsx)("div",{className:"rounded-3xl border border-white/10 bg-black/30 p-4 transition hover:border-white/30",children:(0,a.jsx)(C,{food:e,onAdd:t=>q(e,t)})},"".concat(e.source,"-").concat(null!=(t=e.sourceId)?t:e.name))})]})]})]})]})]})}function C(e){var t,r;let{food:l,onAdd:n,compact:i=!1}=e,{options:o,baseGrams:c}=(0,s.useMemo)(()=>(function(e){var t,r,a,s;let l=function(e){if(!e)return null;let t=e.match(/([\d.]+)\s*(g|gram|grams|oz|ounce|ounces|lb|pound|pounds|ml|milliliter|milliliters|cup|cups)/i);if(!t)return null;let r=parseFloat(t[1]),a=t[2].toLowerCase();return!Number.isFinite(r)||r<=0?null:a.startsWith("g")?{grams:r}:a.startsWith("oz")?{grams:28.349523125*r}:a.startsWith("lb")||a.startsWith("pound")?{grams:453.59237*r}:a.startsWith("cup")?{grams:240*r}:a.startsWith("ml")?{grams:r}:null}(null!=(t=e.per)?t:void 0),n=[];if(null==l?void 0:l.grams){let t=null!=(r=e.per)?r:"".concat(l.grams," g");n.push({value:"base",label:t,toGrams:l.grams}),n.push({value:"g",label:"Grams",toGrams:1}),n.push({value:"oz",label:"Ounces",toGrams:28.349523125}),n.push({value:"cup",label:"Cups (est.)",toGrams:240})}else n.push({value:"serving",label:e.per?"Per ".concat(e.per):null!=(a=e.unit)?a:"Serving"});return{options:n,baseGrams:null!=(s=null==l?void 0:l.grams)?s:null}})(l),[l]),[u,m]=(0,s.useState)(null!=(r=null==(t=o[0])?void 0:t.value)?r:"serving"),[h,g]=(0,s.useState)("1");(0,s.useEffect)(()=>{!o.find(e=>e.value===u)&&o[0]&&m(o[0].value)},[o,u]);let p=parseFloat(h),x=Number.isFinite(p)&&p>0,v=x?p:1,b=o.find(e=>e.value===u),f=(0,s.useMemo)(()=>(null==b?void 0:b.toGrams)&&c?v*b.toGrams/c:v,[b,v,c]),w={calories:l.calories*(x?f:0),protein_g:l.protein_g*(x?f:0),carbs_g:l.carbs_g*(x?f:0),fat_g:l.fat_g*(x?f:0)};return(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)("div",{className:"flex items-start justify-between gap-3",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium text-lg text-white",children:l.name}),(0,a.jsxs)("div",{className:"text-sm text-white/70",children:[l.calories.toFixed(0)," kcal • P ",l.protein_g.toFixed(0),"g • C ",l.carbs_g.toFixed(0),"g • F ",l.fat_g.toFixed(0),"g"]}),(0,a.jsxs)("div",{className:"mt-1 text-xs text-white/60",children:["Source: ","FDC"===l.source?"USDA FDC":l.source," ",l.brand?"• ".concat(l.brand):""," ",l.per?"• per ".concat(l.per):""]})]})}),(0,a.jsxs)("div",{className:"mt-1 flex flex-col gap-4 lg:flex-row lg:items-end lg:justify-between",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-2 text-sm text-white/70 sm:flex-row sm:flex-wrap sm:items-center",children:[(0,a.jsx)("label",{className:"text-xs uppercase tracking-wide text-white/60",children:"Amount"}),(0,a.jsx)("input",{type:"number",min:"0.01",step:"0.1",value:h,onChange:e=>g(e.target.value),className:"w-full max-w-[200px] rounded-2xl border border-white/15 bg-white/10 px-3 py-2 text-sm text-white outline-none transition focus:border-white/40"}),(0,a.jsx)("label",{className:"sr-only",children:"Unit"}),(0,a.jsx)("select",{value:u,onChange:e=>m(e.target.value),className:"w-full max-w-[200px] rounded-2xl border border-white/15 bg-white/10 px-3 py-2 text-sm text-white outline-none transition focus:border-white/40",children:o.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))}),(0,a.jsxs)("span",{className:"text-xs text-white/60",children:["Adds ",w.calories.toFixed(0)," kcal • P ",w.protein_g.toFixed(0),"g • C ",w.carbs_g.toFixed(0),"g • F ",w.fat_g.toFixed(0),"g"]})]}),(0,a.jsx)(d.$,{size:i?"sm":"md",onClick:()=>n(f),disabled:!x,children:"Add"})]})]})}},7972:(e,t,r)=>{"use strict";r.d(t,{Z:()=>l});var a=r(5155);r(2115);var s=r(4269);function l(e){let{className:t,children:r}=e;return(0,a.jsx)("div",{className:(0,s.cn)("w-full rounded-[28px] border border-white/10 bg-white/5 p-5 shadow-[0_30px_80px_rgba(2,4,13,0.65)] backdrop-blur-xl transition-colors duration-200 hover:border-white/20 sm:p-6",t),children:r})}}},e=>{e.O(0,[909,825,619,986,441,255,358],()=>e(e.s=2685)),_N_E=e.O()}]);